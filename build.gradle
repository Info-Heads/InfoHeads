/*
 * This file was generated by the Gradle 'init' task.
 */

import org.apache.tools.ant.filters.ReplaceTokens

plugins {
    id "java"
    id 'maven-publish'
    id "com.github.johnrengelman.shadow" version "8.1.1"
}

ext {
    libsBase = "com.haroldstudios.infoheads.libs"
}

repositories {
    mavenCentral()
    maven {
        url = uri('https://hub.spigotmc.org/nexus/content/repositories/snapshots/')
    }

    maven {
        url = uri('https://jitpack.io')
    }

    maven {
        url = uri('https://repo.codemc.org/repository/maven-public')
    }

    maven {
        url = uri('https://repo.extendedclip.com/content/repositories/placeholderapi/')
    }

    maven {
        url = uri('https://oss.sonatype.org/content/repositories/snapshots/')
    }
}

dependencies {

    compileOnly('org.jetbrains:annotations:13.0')

    testImplementation 'org.junit.jupiter:junit-jupiter:5.7.1'
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
}

jar {
    archiveFileName = "${project.name}.jar"
}

shadowJar {
    archiveFileName = "${project.name}.jar"
    relocate('org.bstats',"${libsBase}.bstats")
}

group = 'com.haroldstudios'
version = '2.5.0'
description = 'InfoHeads'
java.sourceCompatibility = JavaVersion.VERSION_17

tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
}

processResources {
    from(sourceSets.main.resources.srcDirs) {
        duplicatesStrategy DuplicatesStrategy.INCLUDE
        filter ReplaceTokens, tokens: [version: version]
    }
}

tasks.named('test', Test) {
    useJUnitPlatform()

    maxHeapSize = '1G'

    testLogging {
        events "passed"
    }
}

tasks.build.dependsOn tasks.shadowJar